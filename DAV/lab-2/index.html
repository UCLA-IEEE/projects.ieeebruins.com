<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-DAV/lab-2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Lab 2 | IEEE at UCLA Project Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://projects.ieeebruins.com/DAV/lab-2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 2 | IEEE at UCLA Project Docs"><meta data-rh="true" name="description" content="Clocked and Loaded"><meta data-rh="true" property="og:description" content="Clocked and Loaded"><link data-rh="true" rel="icon" href="/img/logo_ieee.svg"><link data-rh="true" rel="canonical" href="https://projects.ieeebruins.com/DAV/lab-2"><link data-rh="true" rel="alternate" href="https://projects.ieeebruins.com/DAV/lab-2" hreflang="en"><link data-rh="true" rel="alternate" href="https://projects.ieeebruins.com/DAV/lab-2" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.18354a95.css">
<script src="/assets/js/runtime~main.62184d40.js" defer="defer"></script>
<script src="/assets/js/main.46815c93.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_ieee.svg" alt="IEEE Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_ieee.svg" alt="IEEE Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IEEE at UCLA Project Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a href="https://ieeebruins.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ieeebruins.com<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/micromouse/">Micromouse</a><button aria-label="Expand sidebar category &#x27;Micromouse&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/pocket-racers/">Pocket Racers</a><button aria-label="Expand sidebar category &#x27;Pocket Racers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/DAV/">DAV</a><button aria-label="Collapse sidebar category &#x27;DAV&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DAV/lab-1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/DAV/lab-2">Lab 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DAV/lab-3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DAV/lab-4">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DAV/lab-5">Lab 5</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/WRAP/">WRAP</a><button aria-label="Expand sidebar category &#x27;WRAP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/DAV/"><span itemprop="name">DAV</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 2</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 2</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="clocked-and-loaded">Clocked and Loaded<a href="#clocked-and-loaded" class="hash-link" aria-label="Direct link to Clocked and Loaded" title="Direct link to Clocked and Loaded">​</a></h3>
<ul>
<li><a href="#0-a-world-divided">0: A World Divided</a>
<ul>
<li><a href="#01-the-clock-divider">0.1: The Clock Divider</a></li>
<li><a href="#02-testing-the-clock-divider">0.2: Testing the Clock Divider</a></li>
<li><a href="#03-general-tips">0.3: General Tips</a></li>
</ul>
</li>
<li><a href="#1-lets-get-this-bread">1: Let&#x27;s Get This Bread</a>
<ul>
<li><a href="#11-using-a-breadboard">1.1: Using a Breadboard</a></li>
<li><a href="#12-buzzers-and-frequencies">1.2: Buzzers and Frequencies</a></li>
</ul>
</li>
<li><a href="#2-an-alarming-rate">2: An Alarming Rate</a>
<ul>
<li><a href="#21-the-block-diagram">2.1: The Block Diagram</a></li>
<li><a href="#22-the-finite-state-machine">2.2: The Finite State Machine</a></li>
</ul>
</li>
<li><a href="#3-its-about-time">3: It&#x27;s About Time</a>
<ul>
<li><a href="#31-implementing-an-fsm">3.1: Implementing an FSM</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>In Lecture 2, you learned about all of the components behind sequential logic. You started from the base gate level, using latches to make flip flops, and flip flops to make registers. You learned about clocks and finite state machines. It’s time to put that knowledge into practice and make an alarm clock with a working buzzer!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-and-reference-material">Resources and Reference Material<a href="#resources-and-reference-material" class="hash-link" aria-label="Direct link to Resources and Reference Material" title="Direct link to Resources and Reference Material">​</a></h2>
<p><a href="https://drive.google.com/file/d/1agTteJ9prdds06XiEAn1TJsO8yg0_HXP/view?usp=drive_link" target="_blank" rel="noopener noreferrer">Link to Lecture 2</a></p>
<p><a href="https://docs.google.com/spreadsheets/d/1jTgphR61ozrNZlr9dLvId5t3o0FrikxSZWwAvhXF0Yo/edit#gid=0" target="_blank" rel="noopener noreferrer">Pin Sheet</a></p>
<p><a href="https://docs.google.com/document/d/1_8ruatZIb3sZb-3Kk3WOYC8Jzv4HvdwrTPZUGVupdVE/edit" target="_blank" rel="noopener noreferrer">Verilog Docs and FAQ</a></p>
<p><a href="https://github.com/amidthestars/DAV-Outreach-Module-Solutions" target="_blank" rel="noopener noreferrer">Solution</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="contact-us">Contact Us<a href="#contact-us" class="hash-link" aria-label="Direct link to Contact Us" title="Direct link to Contact Us">​</a></h2>
<p>You can contact the DAV leads on Discord.</p>
<p><strong>Claire Huang</strong> (Discord: <em>zhiyujia</em>)<br>
<strong>Premkumar Giridhar</strong> (Discord: <em>8bitrobot</em>)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0-a-world-divided">0 A World Divided<a href="#0-a-world-divided" class="hash-link" aria-label="Direct link to 0 A World Divided" title="Direct link to 0 A World Divided">​</a></h2>
<p>In this section of the lab, you’ll be making a clock divider and learning about best practices when writing reusable Verilog modules.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="01-the-clock-divider">0.1 The Clock Divider<a href="#01-the-clock-divider" class="hash-link" aria-label="Direct link to 0.1 The Clock Divider" title="Direct link to 0.1 The Clock Divider">​</a></h3>
<p>For this lab, you’ll need a clock divider. A basic clock divider circuit was covered in the lecture, but now we want to make it better. The goal of this is to give you a customizable clock divider that you can use forever and ever. How do we do that? With <strong>parameters</strong>! Refer to the Verilog Docs and FAQ (linked above) to see how and why we do this.</p>
<p>In this case, your FPGA has a 50 MHz clock on it that you’ll divide into many smaller clocks – so <strong>50000000</strong> would be your parameter’s <strong>default value</strong>. But if you want to divide a different clock, specify that clock’s speed as the parameter value.</p>
<p>You might be wondering: why don’t we use a parameter for the clock <em>speed</em>? Consider that parameters are computed during synthesis (i.e. at compile-time) and not when the circuit is running. If we want to vary the speed of the stopwatch using a switch, we need to use an input to the clock divider module that actually gets computed while the circuit is active.</p>
<p>So let’s add a variable clock speed to our clock dividers – it’s as simple as passing in a <code>speed</code> input. Be careful with how you drive your output clock, though, because an output clock that is generated <em>combinationally</em> will cause <strong>timing violations</strong>; you should be updating a register that drives an output from the module so that your output is updated in sync with the input clock.</p>
<p>All that being said, here’s the “spec” for your clock divider:</p>
<ul>
<li>Your clock divider should accept an input <strong><code>clk</code></strong>, a <strong><code>speed</code></strong> value in Hz, and a <strong><code>reset</code></strong> button as inputs. Its sole output should be an output <strong><code>outClk</code></strong>.</li>
<li>Your clock divider should also have a parameter <strong><code>BASE_SPEED</code></strong> with a default value of <strong>50000000</strong> to indicate that the default base clock speed will be 50000000 Hz, or <strong>50 MHz</strong>.</li>
<li>We tend to use this clock divider module for slower clocks where accuracy isn’t a high concern, so your speed input should only have enough bits to indicate a clock speed of at most <strong>1 MHz</strong>. You should think about how much that is in Hz and calculate the number of bits appropriately. (There’s a neat trick to finding that number of bits – see if you can find it in <a href="https://docs.google.com/document/d_8ruatZIb3sZb-3Kk3WOYC8Jzv4HvdwrTPZUGVupdVE/edit" target="_blank" rel="noopener noreferrer">Verilog Docs and FAQ</a>!)</li>
<li>As we discussed in lecture, the clock divider uses a counter to determine when to flip the clock. The counter’s maximum value is simply your division ratio – if your base clock is 16 Hz and your output speed is 4 Hz, your counter should increment every clock cycle but never exceed <strong>3</strong> , i.e. <strong><code>(BASE_SPEED / speed) - 1</code></strong>.<!-- -->
<ul>
<li>We subtract 1 here because the counter range starts at 0, meaning that a clock period spans 0 to 3 – a total of 4 clock cycles.</li>
</ul>
</li>
<li>This module will require both a sequential block and a combinational block. Recall that when we write sequential circuits, we try to keep our logic contained in the combinational block as much as possible, and we reserve the sequential block for synchronously assigning values.<!-- -->
<ul>
<li>In the <strong>combinational block</strong>, you will determine what the value of your output clock will be for the next clock cycle. If the reset button is pressed, set the output clock to 0. If the counter is less than halfway up to the maximum value, i.e. less than or equal to 1 in the example above, also set the output clock to 0. Otherwise, set it to 1. This will ensure a <strong>50% duty cycle</strong>; most of our peripherals (including the buzzer) are only happy at 50%, so in general you should pick that as your output clock’s duty cycle of choice.<!-- -->
<ul>
<li>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>A common industry standard naming convention is <code>regName_d</code> to indicate the value of <code>regName</code> on the following clock cycle.</p></div></div>
</li>
</ul>
</li>
<li>Also in the <strong>combinational block</strong>, you will determine the next value of your counter. If the reset button is pressed or the counter is at the maximum value as determined by your division factor, the new value of the counter should be 0. Otherwise, it should be the previous counter value incremented by 1.</li>
<li>In the <strong>sequential block</strong>, you should update the values of your <strong>output clock register</strong> and your <strong>counter</strong>. The “new values” of each one should be calculated in the combinational block.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="02-testing-the-clock-divider">0.2 Testing the Clock Divider<a href="#02-testing-the-clock-divider" class="hash-link" aria-label="Direct link to 0.2 Testing the Clock Divider" title="Direct link to 0.2 Testing the Clock Divider">​</a></h3>
<p>Now, how do we test our clock dividers? (You’re testing your clock dividers, right? Right??)</p>
<p>We’ll make a testbench for them!</p>
<p>You can test this by creating a 1 bit clock register in a testbench. In an <strong><code>always</code> block</strong> (with NO sensitivity list!), you can flip this clock register every few simulated nanoseconds.</p>
<p>However, this simulation will go on forever! There’s two ways to stop it – one in Questa, and one in the testbench. In Questa, when the simulation is simulating, you can just click “Break” from the Simulate menu where you hit “Run.” But alternatively, in your testbench code, you can do something like this:</p>
<div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">initial</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// we run this block once when execution begins</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    clock </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// initialize the clock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">#10000</span><span class="token plain"> </span><span class="token kernel-function property" style="color:rgb(12, 150, 155)">$stop</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// after 10000 time ticks, we end simulation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token important">always</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// always w/ no sensitivity only works in simulation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">#10</span><span class="token plain"> clock </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">~</span><span class="token plain">clock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// we toggle the clock every 10 nanoseconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// this runs in parallel to the initial</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// block, so it will stop after 10000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// nanoseconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="03-general-tips">0.3 General Tips<a href="#03-general-tips" class="hash-link" aria-label="Direct link to 0.3 General Tips" title="Direct link to 0.3 General Tips">​</a></h3>
<p>Ideally, all of you would leave DAV knowing how to write decent modules, so here are some other things to look out for. These tips are important both for the clock divider and for the rest of the lab.</p>
<ul>
<li>Make sure your design doesn’t have any <strong>inferred latches</strong>! This means that your combinational logic is <strong>not purely combinational</strong> – some logical error is leading the synthesis tool to think you want memory. This also means that your logic probably isn’t doing what you wanted it to be.<!-- -->
<ul>
<li>You can catch these by using the <strong><code>always_comb</code></strong> block for your combinational logic instead of <strong><code>always @(*)</code></strong> – it’s a SystemVerilog-exclusive block that triggers synthesis errors when latches are inferred in a combinational circuit.</li>
</ul>
</li>
<li>Your sequential logic should be triggered, well, sequentially! It should be triggered <strong>on a clock</strong> and not an arbitrary signal (like a button or switch).</li>
<li>For finite state machines, the next state generation should be <strong>combinational</strong>, while the actual state change event should be <strong>sequential</strong>.<!-- -->
<ul>
<li>The logic that determines the next state should be in a <strong><code>case</code>-statement</strong>.</li>
</ul>
</li>
<li>Remember to use <strong>non-blocking</strong> assignment in sequential logic blocks!</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-lets-get-this-bread">1 Let’s Get This Bread<a href="#1-lets-get-this-bread" class="hash-link" aria-label="Direct link to 1 Let’s Get This Bread" title="Direct link to 1 Let’s Get This Bread">​</a></h2>
<p>We’re going to use a breadboard to set up our buzzer! If you know how breadboards work, you can skip to <a href="#1-2-buzzers-and-frequencies">Buzzers and Frequencies</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-using-a-breadboard">1.1 Using a Breadboard<a href="#11-using-a-breadboard" class="hash-link" aria-label="Direct link to 1.1 Using a Breadboard" title="Direct link to 1.1 Using a Breadboard">​</a></h3>
<p>For those who have never touched a breadboard, here’s a quick introduction.</p>
<p>Here’s a picture of a breadboard. For our purposes, we can ignore the areas between the - and + on either side. (If you’re curious, those would be for if you wanted to attach batteries or power sources.)</p>
<p><img loading="lazy" alt="A diagram of a breadboard." src="/assets/images/image2-17b21f2a1a2830acea7b868ac126224d.png" width="300" height="469" class="img_ev3q"></p>
<p>What we want to observe is the pins in the middle. We’ll refer to the A-J lines as “columns” and the 1-30 lines as “rows.” (A2 would be column A, row 2). Notice the yellow lines connecting everything row-wise? If we want to connect something in series, we would want to connect them using pins in the same row. That’s all we’ll need for the purposes of DAV. (For reference, connecting things across columns would be connecting them in parallel.)</p>
<p>For the buzzer, make sure when you wire it to one of the FPGA pins of your choice, you connect it across the row!</p>
<p><strong>Remember to connect one side of the buzzer to ground!</strong> Refer to its datasheet to determine which side to connect to ground. (Or, if it&#x27;s not polarized, simply connect either one.)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-buzzers-and-frequencies">1.2 Buzzers and Frequencies<a href="#12-buzzers-and-frequencies" class="hash-link" aria-label="Direct link to 1.2 Buzzers and Frequencies" title="Direct link to 1.2 Buzzers and Frequencies">​</a></h3>
<p>The buzzer just needs an oscillating signal to make noise - a clock, for example. Remember how all notes are frequencies? You can look up a note that you want your buzzer to buzz at and find the frequency it needs. You can then generate a clock at that frequency using your clock divider and pass that clock to the output pin, which will be wired to your buzzer!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-an-alarming-rate">2 An Alarming Rate<a href="#2-an-alarming-rate" class="hash-link" aria-label="Direct link to 2 An Alarming Rate" title="Direct link to 2 An Alarming Rate">​</a></h2>
<p>It’s time to get to the actual lab! In this lab, you’ll be making an <strong>alarm clock</strong>. The inputs will be:</p>
<ul>
<li>a start/stop button</li>
<li>a reset button</li>
<li>the switches</li>
<li>the built in 50 MHz clock</li>
</ul>
<p>The outputs will be the six seven-segment displays on the board and a buzzer. Two digits are the minutes, two digits are the seconds, and two digits are hundredths of a second.</p>
<p>For example, 103325 would be 10 minutes and 33.25 seconds. <em>(Hint: This means that you’ll need digits in base 6 as well as base 10.)</em></p>
<p>The design will be as follows:</p>
<ul>
<li>When the start/stop button is pressed, the timer should toggle between <strong>running</strong> and <strong>being paused</strong>.<!-- -->
<ul>
<li>Remember! Our buttons are <strong>active low</strong> – when they’re not pressed, their output is <strong>high</strong>.</li>
<li>When running, the clock should be counting down, and this should show up on the display as well.</li>
<li>When paused, the display should remain at whatever time the display showed when it was first paused.</li>
</ul>
</li>
<li>The rightmost switch will be a speed switch that, when enabled, runs the alarm clock down twice as fast.</li>
<li>The remaining nine switches will be used to control the starting time on the clock when it’s being set.</li>
<li>When the reset button is pressed, the timer should deactivate and return to the starting value as determined by the switches.</li>
<li>The output digits should be displayed on the seven-segment displays, and you can simply <strong>modify your modules from lab 1</strong>.<!-- -->
<ul>
<li>Note that unlike in lab 1, certain digits can only be from <strong>0 to 5</strong> instead of the usual <strong>0 to 9</strong> (so you’ll have to modify your code to reflect that).</li>
</ul>
</li>
<li>When the alarm clock runs down to zero, the buzzer should activate at an audible frequency of your choice.</li>
</ul>
<p>So how do we get started?</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-the-block-diagram">2.1 The Block Diagram<a href="#21-the-block-diagram" class="hash-link" aria-label="Direct link to 2.1 The Block Diagram" title="Direct link to 2.1 The Block Diagram">​</a></h3>
<p><strong>This section does not require writing any code. Read it and move onto the next part before writing any Verilog.</strong></p>
<p>We’re going to provide you with a block diagram for the alarm clock. A block diagram is essentially a bird’s-eye view of all the modules in the stopwatch and how they go together. This is a simplified version, i.e. not everything is connected up and <strong>the buzzer is missing</strong> – if it were complete, you wouldn’t have very much to figure out yourself :-)</p>
<p><img loading="lazy" alt="A semi-complete block diagram of an alarm clock, with each block representing a module. The first module, &amp;quot;clockDivider,&amp;quot; is clocked by the 50 megahertz clock from the FPGA, takes in a speed switch as input, and outputs a new clock at the desired speed. This divided clock becomes the clock for the alarmController module, which also takes in the buttons as input. The output of this module goes into the alarmClock top module, which contains the seven segment display and seven segment digit modules. The alarmClock top module outputs six buses that go into the FPGA&amp;#39;s seven segment displays." src="/assets/images/image1-0a7458d4785daf50017d31ee57ac98ef.png" width="1277" height="412" class="img_ev3q"></p>
<ul>
<li>Each rectangle is a “block,” or a module with the given name. (You can choose your own names if you’d like.)</li>
<li>The wires coming from within <code>FPGA</code> are pins on the FPGA that you will route into your top level module, <code>alarmClock_top</code>.</li>
<li>Ports coming out of the smaller modules will need to be declared as wires and driven by the output of that module. For example, you’ll need a wire driven by the output of <code>clockDivider</code> that gets routed as an input into <code>alarmController</code>.</li>
<li>A little triangle at the bottom of a module indicates that the module is sequential and uses the wire going into the triangle as a clock. For example, our clock divider is clocked on the FPGA’s own 50 MHz clock pin.</li>
<li>A wire with a line through it indicates that that wire is made up of many bits. These multi-bit wires are formally known as <em>buses</em>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-the-finite-state-machine">2.2 The Finite State Machine<a href="#22-the-finite-state-machine" class="hash-link" aria-label="Direct link to 2.2 The Finite State Machine" title="Direct link to 2.2 The Finite State Machine">​</a></h3>
<p>It’s time to make a finite state machine of our own! Yay!</p>
<p>First, we have to design it. This entails drawing the diagram with the circles and arrows. We’ll give you a description of the states, their transitions, and how they affect the outputs; and it’ll be up to you to figure out how to put the pieces together.</p>
<p>Here are a few quick hints for you when you’re designing your FSM.</p>
<ul>
<li>There are three values in this system that will trigger state transitions: the <strong>pause/start button</strong>, the <strong>reset button</strong>, and the <strong>time remaining</strong> on the alarm clock. You do not need a state transition triggered by any other input.</li>
<li>Remember the strategy we discussed in lecture for reading the edge of an external input, like a button or an external clock? You’ll need to apply that here!</li>
</ul>
<p>Last note: FSMs are scary! If you need help or can’t figure out how to piece it all together, please reach out to us – we’re happy to provide a few more hints!</p>
<p><strong>SET</strong></p>
<ul>
<li>In this state, <strong>9 switches</strong> (don’t include the clock speed switch!) can be used to manually adjust the <strong>time remaining</strong> on the clock.<!-- -->
<ul>
<li>The switches can be treated as one 9-bit number, with the binary representation of the switches indicating the number of seconds (NOT the hundredths of a second).</li>
</ul>
</li>
<li>If the user presses the **pause/start button, **the alarm clock should start <strong>RUN</strong>ning.</li>
<li>If the user presses the <strong>reset button,</strong> nothing should happen, i.e. the alarm clock should stay in this state.</li>
</ul>
<p><strong>RUN</strong></p>
<ul>
<li>During this state, changing the switches should not impact the timer.</li>
<li>The time remaining should count down every second or half a second, depending on the speed of the alarm clock as indicated by the speed switch.<!-- -->
<ul>
<li>Note that this doesn’t mean the speed switch has to be an input to the FSM! You can accomplish this just as easily by having the</li>
</ul>
</li>
<li>If the user presses the <strong>pause/start button,</strong> then the timer should be <strong>PAUSE</strong>d.</li>
<li>If the user presses the <strong>reset button,</strong> the timer should be re<strong>SET</strong>.</li>
<li>If the time remaining reaches zero, the alarm clock should start <strong>BEEP</strong>ing.</li>
</ul>
<p><strong>PAUSE</strong></p>
<ul>
<li>During this state, the timer should not count down, and the display should flash the paused time.<!-- -->
<ul>
<li>It’s up to you what frequency the flash is, however, please make sure the flash is discernible.</li>
</ul>
</li>
<li>If the user presses the <strong>stop/start button,</strong> the timer should resume <strong>RUN</strong>ning.</li>
<li>If the user presses the <strong>reset button,</strong> the timer should be re<strong>SET</strong>.</li>
</ul>
<p><strong>BEEP</strong></p>
<ul>
<li>During the <strong>BEEP</strong> state, the buzzer beeps, and the display flashes at 00:00:00 to show that the timer has finished.<!-- -->
<ul>
<li>In the event that you are hearing-challenged like I (Claire) am, this buzzer is barely audible. You need to really lean close to hear it, and even then, I still couldn’t hear it :(</li>
</ul>
</li>
<li>If the user presses the **stop/start button, **nothing happens.</li>
<li>If the user presses the reset** button,** the timer should be re<strong>SET</strong>.</li>
</ul>
<p>Remember: For finite state machines, the next state should be computed <strong>combinationally</strong> based on the current state (and sometimes the inputs), but the actual state change event should be <strong>sequential</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-its-about-time">3 It’s About Time<a href="#3-its-about-time" class="hash-link" aria-label="Direct link to 3 It’s About Time" title="Direct link to 3 It’s About Time">​</a></h2>
<p>Now that you have the finite state machine drawn out and the buzzer set up, it’s time to code it! Refer to the <a href="#2-1-the-block-diagram">block diagram in 2.1</a>. You already made your clock divider and you have seven-segment digits from Lab 1. In this part of the lab, you need to write your top level module <code>alarmClock_top</code> – which merely declares input/output ports and wires the other modules together – and your <code>alarmController</code>. The <code>alarmController</code>, of course, will be your FSM module – you should write the Verilog code for your FSM as you designed it in section 2.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-implementing-an-fsm">3.1 Implementing an FSM<a href="#31-implementing-an-fsm" class="hash-link" aria-label="Direct link to 3.1 Implementing an FSM" title="Direct link to 3.1 Implementing an FSM">​</a></h3>
<p>Here’s a quick primer on how to implement an FSM in Verilog. <strong>The following code blocks are examples with arbitrary state transitions, state names, and outputs; only the overall code structure is relevant and not the values or names themselves.</strong></p>
<p>Your module will need to have two <code>always</code> blocks: one sequential (clocked) and one combinational. In the sequential block, you should capture the edges of any unsynchronized values, set your outputs, and execute state transitions.</p>
<div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">input</span><span class="token plain"> button</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">output</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">reg</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> outVal</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">reg</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> button_sr</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">reg</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> currentState</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">reg</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// the next state to be assigned</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">reg</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> outVal_d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// the next output value to be assigned</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token important">always @</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token keyword" style="color:rgb(12, 150, 155)">posedge</span><span class="token plain"> clk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* shift the shift register left by 1 and</span><br></span><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">    store the current button value */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    button_sr </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">{</span><span class="token plain"> button_sr</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> button </span><span class="token operator" style="color:rgb(12, 150, 155)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* state transition */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    currentState </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;=</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* output assignment */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    outVal </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;=</span><span class="token plain"> outVal_d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the combinational block, you determine the next state depending on your current state, your inputs, and any other values. You also determine the “next” output value to be assigned on the next clock cycle. Remember to use <code>localparams</code> to give your state values actual labels! It helps make your code more readable.</p>
<div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">localparam</span><span class="token plain"> STATE1 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">2&#x27;b00</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">localparam</span><span class="token plain"> STATE2 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">2&#x27;b01</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* other states go here */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token important">always_comb</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">case</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">currentState</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        STATE1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* remember that this won&#x27;t be &quot;assigned&quot;</span><br></span><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">            until the sequential block executes on</span><br></span><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">            the clock edge! */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* if the button has a positive edge (i.e.</span><br></span><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">            it was just pressed, transition states */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">button_sr </span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">2&#x27;b01</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                nextState </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> STATE2</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                outVal_d </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">2&#x27;b01</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                nextState </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> STATE1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                outVal_d </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">2&#x27;b11</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* other states go here */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">endcase</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Just one more tip: for the display flashing, you don’t need a separate state or state machine (apart from BEEP)! Think about whether or not you could use bit tricks to override what the display is showing.</p>
<p>Happy coding, and don’t forget to pin plan!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/UCLA-IEEE/projects.ieeebruins.com/tree/main/docs/DAV/lab-2.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/DAV/lab-1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/DAV/lab-3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 3</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#clocked-and-loaded" class="table-of-contents__link toc-highlight">Clocked and Loaded</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#resources-and-reference-material" class="table-of-contents__link toc-highlight">Resources and Reference Material</a></li><li><a href="#contact-us" class="table-of-contents__link toc-highlight">Contact Us</a></li><li><a href="#0-a-world-divided" class="table-of-contents__link toc-highlight">0 A World Divided</a><ul><li><a href="#01-the-clock-divider" class="table-of-contents__link toc-highlight">0.1 The Clock Divider</a></li><li><a href="#02-testing-the-clock-divider" class="table-of-contents__link toc-highlight">0.2 Testing the Clock Divider</a></li><li><a href="#03-general-tips" class="table-of-contents__link toc-highlight">0.3 General Tips</a></li></ul></li><li><a href="#1-lets-get-this-bread" class="table-of-contents__link toc-highlight">1 Let’s Get This Bread</a><ul><li><a href="#11-using-a-breadboard" class="table-of-contents__link toc-highlight">1.1 Using a Breadboard</a></li><li><a href="#12-buzzers-and-frequencies" class="table-of-contents__link toc-highlight">1.2 Buzzers and Frequencies</a></li></ul></li><li><a href="#2-an-alarming-rate" class="table-of-contents__link toc-highlight">2 An Alarming Rate</a><ul><li><a href="#21-the-block-diagram" class="table-of-contents__link toc-highlight">2.1 The Block Diagram</a></li><li><a href="#22-the-finite-state-machine" class="table-of-contents__link toc-highlight">2.2 The Finite State Machine</a></li></ul></li><li><a href="#3-its-about-time" class="table-of-contents__link toc-highlight">3 It’s About Time</a><ul><li><a href="#31-implementing-an-fsm" class="table-of-contents__link toc-highlight">3.1 Implementing an FSM</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More of us!</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/RREtsea" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://instagram.com/uclaieee" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 IEEE at UCLA. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>