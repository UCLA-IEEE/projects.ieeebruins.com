<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-DAV/lab-3" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Lab 3 | IEEE at UCLA Project Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://projects.ieeebruins.com/projects.ieeebruins.com/DAV/lab-3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 3 | IEEE at UCLA Project Docs"><meta data-rh="true" name="description" content="6 FFT Under"><meta data-rh="true" property="og:description" content="6 FFT Under"><link data-rh="true" rel="icon" href="/projects.ieeebruins.com/img/logo_ieee.svg"><link data-rh="true" rel="canonical" href="https://projects.ieeebruins.com/projects.ieeebruins.com/DAV/lab-3"><link data-rh="true" rel="alternate" href="https://projects.ieeebruins.com/projects.ieeebruins.com/DAV/lab-3" hreflang="en"><link data-rh="true" rel="alternate" href="https://projects.ieeebruins.com/projects.ieeebruins.com/DAV/lab-3" hreflang="x-default"><link rel="stylesheet" href="/projects.ieeebruins.com/assets/css/styles.18354a95.css">
<script src="/projects.ieeebruins.com/assets/js/runtime~main.b1ef1bd4.js" defer="defer"></script>
<script src="/projects.ieeebruins.com/assets/js/main.703d347d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/projects.ieeebruins.com/"><div class="navbar__logo"><img src="/projects.ieeebruins.com/img/logo_ieee.svg" alt="IEEE Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/projects.ieeebruins.com/img/logo_ieee.svg" alt="IEEE Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IEEE at UCLA Project Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/projects.ieeebruins.com/">Docs</a><a href="https://ieeebruins.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ieeebruins.com<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/projects.ieeebruins.com/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/projects.ieeebruins.com/micromouse/">Micromouse</a><button aria-label="Expand sidebar category &#x27;Micromouse&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/projects.ieeebruins.com/pocket-racers/">Pocket Racers</a><button aria-label="Expand sidebar category &#x27;Pocket Racers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/projects.ieeebruins.com/DAV/">DAV</a><button aria-label="Collapse sidebar category &#x27;DAV&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/DAV/lab-1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/DAV/lab-2">Lab 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/projects.ieeebruins.com/DAV/lab-3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/DAV/lab-4">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/DAV/lab-5">Lab 5</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/projects.ieeebruins.com/WRAP/">WRAP</a><button aria-label="Expand sidebar category &#x27;WRAP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/projects.ieeebruins.com/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/projects.ieeebruins.com/DAV/"><span itemprop="name">DAV</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 3</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 3</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-fft-under">6 FFT Under<a href="#6-fft-under" class="hash-link" aria-label="Direct link to 6 FFT Under" title="Direct link to 6 FFT Under">​</a></h3>
<ul>
<li><a href="#0-useful-diagrams">0 Useful Diagrams</a></li>
<li><a href="#1-a-twiddle-bit-annoying">1 A Twiddle Bit Annoying</a></li>
<li><a href="#2-i-cant-believe-its-not-butter-fly">2 I can&#x27;t belive it&#x27;s not butter-fly</a>
<ul>
<li><a href="#21-the-ports">2.1 The Ports</a></li>
<li><a href="#22-the-multiplication">2.2 The Multiplication</a></li>
</ul>
</li>
<li><a href="#3-4ruit-by-the-fft">3 4ruit by the FFT</a></li>
<li><a href="#4-youre-fourgiven">4 You&#x27;re Fourgiven</a></li>
<li><a href="#5-checkoff">5 Checkoff</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Ah yes, the FFT. In lecture 3, we covered how the Fast Fourier Transform (FFT) works conceptually and broke it down into parts, and now it’s your turn to make it! In this lab, you’ll be taking four inputs, designing butterfly units, and connecting them to form a 4-point FFT module. This is the basic building block to the final Digital Audio Visualizer capstone, where you’ll need to take audio signals and convert them to the frequency domain with a minimum of a 16-point FFT.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-and-reference-material">Resources and Reference Material<a href="#resources-and-reference-material" class="hash-link" aria-label="Direct link to Resources and Reference Material" title="Direct link to Resources and Reference Material">​</a></h2>
<p><a href="https://drive.google.com/file/d/1ZpZNq0DCSLgWa0FdoBjDLQwYdLYMBiAf/view?usp=sharing" target="_blank" rel="noopener noreferrer">Link to Lecture 3</a></p>
<p><a href="https://docs.google.com/spreadsheets/d/1jTgphR61ozrNZlr9dLvId5t3o0FrikxSZWwAvhXF0Yo/edit#gid=0" target="_blank" rel="noopener noreferrer">Pin Sheet</a></p>
<p><a href="https://docs.google.com/document/d/1_8ruatZIb3sZb-3Kk3WOYC8Jzv4HvdwrTPZUGVupdVE/edit" target="_blank" rel="noopener noreferrer">Verilog Docs</a></p>
<p><a href="https://github.com/amidthestars/DAV-Outreach-Module-Solutions" target="_blank" rel="noopener noreferrer">Solution</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="contact-us">Contact Us<a href="#contact-us" class="hash-link" aria-label="Direct link to Contact Us" title="Direct link to Contact Us">​</a></h2>
<p>You can contact the DAV leads on Discord.</p>
<p><strong>Claire Huang</strong> (Discord: <em>zhiyujia</em>)<br>
<strong>Premkumar Giridhar</strong> (Discord: <em>8bitrobot</em>)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0-useful-diagrams">0 Useful Diagrams<a href="#0-useful-diagrams" class="hash-link" aria-label="Direct link to 0 Useful Diagrams" title="Direct link to 0 Useful Diagrams">​</a></h2>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image13-cd4b5a0a2f8f0b758adb7644fb46ba09.png" width="729" height="440" class="img_ev3q">
<img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image14-f8932f2ec658c4ea5ea8d93f5742841f.png" width="1999" height="778" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-a-twiddle-bit-annoying">1 A Twiddle Bit Annoying<a href="#1-a-twiddle-bit-annoying" class="hash-link" aria-label="Direct link to 1 A Twiddle Bit Annoying" title="Direct link to 1 A Twiddle Bit Annoying">​</a></h2>
<p>Let’s start out with our twiddle factors. In this lab, we’ll be working with inputs that are 32 bits each – 16 real and 16 imaginary. This means that our twiddle factor will <em>also</em> be 32 bits, with 16 real bits and 16 imaginary. Remember to keep everything in two’s complement form!</p>
<p>Recall what a twiddle factor is from Lecture 3:</p>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image15-39f735bfe0ba54d5db43118a63dc574e.png" width="806" height="104" class="img_ev3q"></p>
<p>Also recall from lecture that we derive these twiddle factors by dividing up a unit circle. You’d usually expect four twiddle factors; but due to the symmetry of the unit circle, we can get away with just two (each one being positive/negative). That’s why in the 4-point FFT diagram above, there are only two twiddle factors (but their positions on the unit circle are the same as before!). You can use Euler’s, as shown in the equation above, to calculate these twiddle factors - the cosine part will be real, and the sine part will be imaginary.</p>
<p>In lecture, we also discussed that at the end of the multiplication process, we truncate by discarding the sign bit and taking the next 16 bits, discarding the last 15 at the end. Remember that this is essentially <strong>dividing the result by 2<sup>15</sup></strong>. In order to counter this operation and avoid losing magnitude in our numbers, remember to left-shift your twiddle factor by 15, or more simply <strong>multiply it by 2<sup>15</sup></strong> prior to encoding it into your module.</p>
<p>In Verilog, floating point math is hard, but signed integer math is easy! This has the following implications on our module.</p>
<ul>
<li>Every single port and wire in the butterfly unit should be declared using the <code>signed</code> keyword. This will affect the automatic sign-extension and rounding/overflow behavior, so it’s very important that you remember to include it.</li>
</ul>
<div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">module</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">input</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">signed</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">WIDTH</span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> A</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">wire</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">signed</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">WIDTH</span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> C </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">endmodule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Once you multiply your twiddle factor by 2<sup>15</sup>, you need to round to the nearest 16-bit integer and use that value as the twiddle factor in your module.</li>
<li>When your twiddle factor is <strong>1</strong>, multiplying it by 2<sup>15</sup> will cause it to overflow, you should instead use the largest possible signed 16-bit value – <strong>16’b0111 1111 1111 1111</strong>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-i-cant-believe-its-not-butter-fly">2 I can’t believe it’s not butter-fly<a href="#2-i-cant-believe-its-not-butter-fly" class="hash-link" aria-label="Direct link to 2 I can’t believe it’s not butter-fly" title="Direct link to 2 I can’t believe it’s not butter-fly">​</a></h2>
<p>It’s time to build the basic building block of our Fast Fourier Transform! Recall from lecture that the butterfly unit looks like this:</p>
<p><img loading="lazy" alt="alt_text" src="data:image/png;base64,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" width="428" height="192" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-the-ports">2.1 The Ports<a href="#21-the-ports" class="hash-link" aria-label="Direct link to 2.1 The Ports" title="Direct link to 2.1 The Ports">​</a></h3>
<p>Your butterfly unit should have the following:</p>
<ul>
<li>A <strong>parameter</strong> named <strong>WIDTH</strong> that determines the number of bits in the inputs. Our inputs for this part are 32 bits (16 real and 16 imaginary), so give it a <strong>default value of 32</strong>.<!-- -->
<ul>
<li>If you don&#x27;t know what parameters are, please refer to the Verilog Docs section on the topic :)</li>
</ul>
</li>
<li>Three <strong>WIDTH</strong> sized inputs. These will be A, B, and W.</li>
<li>Two <strong>WIDTH</strong> sized outputs. These will be (A+WB) and (A-WB).</li>
</ul>
<p>As mentioned before, everything will be in the same format - the left <strong>WIDTH</strong>/2 bits will be real, and the right <strong>WIDTH</strong>/2 bits will be imaginary. It might help you to split these up into separate wires within the module for the real and imaginary component of each input, to make the math easier to follow around.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-the-multiplication">2.2 The Multiplication<a href="#22-the-multiplication" class="hash-link" aria-label="Direct link to 2.2 The Multiplication" title="Direct link to 2.2 The Multiplication">​</a></h3>
<p>When we’re multiplying two complex numbers, we can use the FOIL method.</p>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image17-c058c6a6f8adc1b04e68b01045719892.png" title="image_tooltip" width="949" height="197" class="img_ev3q"></p>
<p>Make sure to test your results using a testbench! We’ve added a Python script to help you out with this. In the script, you should be able to input <em>A<sub>real</sub>, B<sub>real</sub>, A<sub>imag</sub></em>, and <em>B<sub>imag</sub></em>, as well as 4 twiddle factors. You should test that your outputs match the script; you may find your results off by a small amount, but it’s okay as long as your outputs are really only off by a little bit. It helps to test your module with somewhat large values – say, ±100 or greater – because the math is more susceptible to these rounding errors when the numbers are smaller.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-4ruit-by-the-fft">3 4ruit by the FFT<a href="#3-4ruit-by-the-fft" class="hash-link" aria-label="Direct link to 3 4ruit by the FFT" title="Direct link to 3 4ruit by the FFT">​</a></h2>
<p>It’s time to make the 4-point FFT!</p>
<p>We want to build the FFT using a finite state machine. Our inputs will look a little bit different! Now, we have:</p>
<ul>
<li><strong>Four</strong> 32-bit complex inputs representing the samples being FFT’d</li>
<li>1-bit clock, 1-bit reset inputs</li>
<li>1-bit start input</li>
</ul>
<p>And now, we want to output:</p>
<ul>
<li>**Four ** 32-bit complex outputs</li>
<li>1-bit “done” output (indicating when the FFT computation is done)</li>
</ul>
<p>So how do we make this a finite state machine? We can treat each vertical “layer” of butterfly units as a state, along with a “RESET” state and a “DONE” state. During each state of our module, the inputs to the butterfly units will be set as the outputs of the previous state. This also means that we can reuse our butterfly units, so you’ll only need enough butterfly unit instantiations to perform the computations for one state. The twiddle factors will be hardcoded into this module.</p>
<p>Since we’re doing a 4-point FFT, we only need log<sub>2</sub>(<strong>4</strong>) = <strong>2 stages</strong>. Our finite state machine could look like this:</p>
<table><thead><tr><th><strong>State</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><strong>RESET</strong></td><td>Outputs are held at 0 until the <strong>start input</strong> goes high. When it does, go to <strong>STAGE1</strong>.</td></tr><tr><td><strong>STAGE1</strong></td><td>The butterfly units’ inputs are set as the inputs to the module. The outputs are then calculated combinatorially. After one clock cycle, go to <strong>STAGE2</strong>.</td></tr><tr><td><strong>STAGE2</strong></td><td>The butterfly units’ outputs are used to update their own inputs – refer to the diagram for the correct wiring. After one clock cycle, go to <strong>DONE</strong>.</td></tr><tr><td><strong>DONE</strong></td><td>The outputs of the module are set to the results of <strong>STAGE2</strong>. The done flag is set high. Wait until the <strong>reset input</strong> goes high to return to <strong>RESET</strong>.</td></tr></tbody></table>
<p>Once you’re done, use our testbench to test your new 32-bit 4-point FFT! You can then check this with the Python script to verify that the outputs are correct.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-youre-fourgiven">4 You’re Fourgiven<a href="#4-youre-fourgiven" class="hash-link" aria-label="Direct link to 4 You’re Fourgiven" title="Direct link to 4 You’re Fourgiven">​</a></h2>
<p>Anyways, you’re almost done with this lab! Just one more thing to do.</p>
<p>We’re now going to transform our 32-bit FFT into a 16-bit FFT! This is useful because sometimes we want to use less precision to save space. This should be trivial if you parametrized everything earlier. Just change <strong>WIDTH</strong> to 16 (and make other changes to variable sizes as necessary). Remember, the twiddle factor only needs to be shifted by 7, and the truncation is also slightly different.</p>
<p>Make sure to test your design with a testbench!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/UCLA-IEEE/projects.ieeebruins.com/tree/main/docs/DAV/lab-3.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/projects.ieeebruins.com/DAV/lab-2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/projects.ieeebruins.com/DAV/lab-4"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 4</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#6-fft-under" class="table-of-contents__link toc-highlight">6 FFT Under</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#resources-and-reference-material" class="table-of-contents__link toc-highlight">Resources and Reference Material</a></li><li><a href="#contact-us" class="table-of-contents__link toc-highlight">Contact Us</a></li><li><a href="#0-useful-diagrams" class="table-of-contents__link toc-highlight">0 Useful Diagrams</a></li><li><a href="#1-a-twiddle-bit-annoying" class="table-of-contents__link toc-highlight">1 A Twiddle Bit Annoying</a></li><li><a href="#2-i-cant-believe-its-not-butter-fly" class="table-of-contents__link toc-highlight">2 I can’t believe it’s not butter-fly</a><ul><li><a href="#21-the-ports" class="table-of-contents__link toc-highlight">2.1 The Ports</a></li><li><a href="#22-the-multiplication" class="table-of-contents__link toc-highlight">2.2 The Multiplication</a></li></ul></li><li><a href="#3-4ruit-by-the-fft" class="table-of-contents__link toc-highlight">3 4ruit by the FFT</a></li><li><a href="#4-youre-fourgiven" class="table-of-contents__link toc-highlight">4 You’re Fourgiven</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More of us!</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/RREtsea" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://instagram.com/uclaieee" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 IEEE at UCLA. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>