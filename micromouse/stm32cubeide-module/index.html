<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-micromouse/stm32cubeide-module" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">STM32CubeIDE Module | IEEE at UCLA Project Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://projects.ieeebruins.com/projects.ieeebruins.com/micromouse/stm32cubeide-module"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="STM32CubeIDE Module | IEEE at UCLA Project Docs"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/projects.ieeebruins.com/img/logo_ieee.svg"><link data-rh="true" rel="canonical" href="https://projects.ieeebruins.com/projects.ieeebruins.com/micromouse/stm32cubeide-module"><link data-rh="true" rel="alternate" href="https://projects.ieeebruins.com/projects.ieeebruins.com/micromouse/stm32cubeide-module" hreflang="en"><link data-rh="true" rel="alternate" href="https://projects.ieeebruins.com/projects.ieeebruins.com/micromouse/stm32cubeide-module" hreflang="x-default"><link rel="stylesheet" href="/projects.ieeebruins.com/assets/css/styles.18354a95.css">
<script src="/projects.ieeebruins.com/assets/js/runtime~main.b1ef1bd4.js" defer="defer"></script>
<script src="/projects.ieeebruins.com/assets/js/main.703d347d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/projects.ieeebruins.com/"><div class="navbar__logo"><img src="/projects.ieeebruins.com/img/logo_ieee.svg" alt="IEEE Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/projects.ieeebruins.com/img/logo_ieee.svg" alt="IEEE Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IEEE at UCLA Project Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/projects.ieeebruins.com/">Docs</a><a href="https://ieeebruins.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ieeebruins.com<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/projects.ieeebruins.com/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/projects.ieeebruins.com/micromouse/">Micromouse</a><button aria-label="Collapse sidebar category &#x27;Micromouse&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/power-module">Power Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/motors-and-encoders-module">Motors and Encoders Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/ir-sensors-module">IR Sensors Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/microcontroller-module">Microcontroller Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/projects.ieeebruins.com/micromouse/stm32cubeide-module">STM32CubeIDE Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/motor-setup-and-pid-module">Motor Setup and PID Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/ir-code-module">IR Code Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/floodfill-module">Floodfill Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/q-and-a">Q&amp;A</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projects.ieeebruins.com/micromouse/aamc">AAMC</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/projects.ieeebruins.com/pocket-racers/">Pocket Racers</a><button aria-label="Expand sidebar category &#x27;Pocket Racers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/projects.ieeebruins.com/DAV/">DAV</a><button aria-label="Expand sidebar category &#x27;DAV&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/projects.ieeebruins.com/WRAP/">WRAP</a><button aria-label="Expand sidebar category &#x27;WRAP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/projects.ieeebruins.com/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/projects.ieeebruins.com/micromouse/"><span itemprop="name">Micromouse</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">STM32CubeIDE Module</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>STM32CubeIDE Module</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<ol>
<li><a href="#installing-cubeide">Installing CubeIDE</a></li>
<li><a href="#coding-in-cubeide">Coding in CubeIDE</a></li>
</ol>
<p>In this module you will learn about the software that we use to program the STM32 microcontrollers! We will walk you through setting up the IDE, and some basic code to get you familiar with the software. At this point, you should have finished your schematic, PCB, and have started the soldering components onto your mouse!</p>
<p>If you need help for the code part of this module or want to verify your code, you can check <a href="https://drive.google.com/drive/folders/1PAeCPyS8xuI77j-Z--dN4X3imm9GURkr?usp=drive_link" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-cubeide">Installing CubeIDE<a href="#installing-cubeide" class="hash-link" aria-label="Direct link to Installing CubeIDE" title="Direct link to Installing CubeIDE">​</a></h2>
<p>The STM microcontrollers can be programmed and configured using the STM32CubeIDE. In this section, we will walk you through setting up the software for your mice so that you can get it up and running!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-download-installer">Step 1: Download Installer<a href="#step-1-download-installer" class="hash-link" aria-label="Direct link to Step 1: Download Installer" title="Direct link to Step 1: Download Installer">​</a></h3>
<ul>
<li>Visit <a href="https://www.st.com/en/development-tools/stm32cubeide.html" target="_blank" rel="noopener noreferrer">this website</a> and click the “Get Software” button. Then click the “Get Software” button next to your operating system.</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image14-a2f8164496e67c92ca803ecafd3c8c8a.png" title="image_tooltip" width="1999" height="368" class="img_ev3q"></p>
<ul>
<li>Accept the license agreement. You will then be prompted to either login/register with a my.st.com account or just validate your email once. Either option is fine; it is fastest to just enter your name and email address and validate it in the email they send you if you do not already have an account.</li>
<li>If you enter your email address, the download link will be in the email sent to you. Except it will say your name instead of “Tyler” <!-- -->:D</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image10-6bbea552b29fbf0ebd07a2099e78ad85.png" title="image_tooltip" width="590" height="315" class="img_ev3q"></p>
<ul>
<li>Extract and run the installer. It’s normal for the installation to take a while!</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-setup-cubeide">Step 2: Setup CubeIDE<a href="#step-2-setup-cubeide" class="hash-link" aria-label="Direct link to Step 2: Setup CubeIDE" title="Direct link to Step 2: Setup CubeIDE">​</a></h3>
<ul>
<li>Launch CubeIDE. Default directory is fine, just press “Launch” when prompted.</li>
<li>Click “Start new STM32 project”</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image8-c09c166b51d214c9ccc4cbc206638b6c.png" title="image_tooltip" width="522" height="238" class="img_ev3q"></p>
<ul>
<li>You will now have to select the correct MCU for the project. On the tabs at the top, click “Board Selector”, then in the search bar type “Nucleo-F411RE” (or whichever board you’re using). Only one device should show up. Click on that one and select “Next”.</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image6-b7e71cca910350d9eb08c5a54f412a46.png" title="image_tooltip" width="957" height="180" class="img_ev3q"></p>
<ul>
<li>In the following prompt, give your project an appropriate name and select “Finish”</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image13-409c707fdf9c3d5ad8efedea4366572e.png" title="image_tooltip" width="477" height="532" class="img_ev3q"></p>
<ul>
<li>A dialogue box will ask if you want to open the STM32CubeMx perspective. Press yes. CubeIDE will then download the necessary software packages.</li>
<li>That’s it for the setup!</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="coding-in-cubeide">Coding in CubeIDE<a href="#coding-in-cubeide" class="hash-link" aria-label="Direct link to Coding in CubeIDE" title="Direct link to Coding in CubeIDE">​</a></h2>
<p>So far, you installed CubeIDE and set up a project for the microcontroller used on the STM32F411RE board. This final part of the assignment will walk you through writing your first program in CubeIDE. Your program, when finished, will light up an LED on the Nucleo when a button is pressed. Both the LED and button are built into the Nucleo, so there is no hardware assembly required for this part of the assignment.</p>
<p>Typically the workflow for a project in CubeIDE are as follows:</p>
<ol>
<li>Configure the pins on the microcontroller to do what you want. This may mean setting a pin to behave as an input or output, configuring a pin to interface with a timer or interrupt in the microcontroller, and so on.</li>
<li>Once configured, CubeIDE will generate some low level driver code and define some constants for you that you can use in your actual written code to refer to the pins you configured.</li>
<li>Write the code!</li>
<li>Upload your code to the MCU.</li>
</ol>
<p>NOTE: Before getting started, you should at least the full power delivery schematic soldered onto your board. This includes the voltage regulator, its decoupling capacitors, the jst connectors for the batteries, and the power switch. Furthermore, you must have the 2 2x19 pin headers soldered on to be able to connect the nucleo to your mouse. Finally, you should have the 4 pin programming header soldered on to be able to interface with the mcu.</p>
<p>CubeIDE may look big and complicated initially, but this assignment will walk you through all the basics you need to know. Let’s get started!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-configure-microcontroller-pins">Step 1: Configure Microcontroller Pins<a href="#step-1-configure-microcontroller-pins" class="hash-link" aria-label="Direct link to Step 1: Configure Microcontroller Pins" title="Direct link to Step 1: Configure Microcontroller Pins">​</a></h2>
<ul>
<li>When you first open your project in CubeIDE, you should see a screen like this:</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image3-75804b23e706ff9ecfff1ad8d8c4d349.png" title="image_tooltip" width="1172" height="721" class="img_ev3q"></p>
<ul>
<li>This is called the “Device Configuration Tool.” If you don’t see it, expand your project director in the left sidebar and open up a file ending in .ioc.</li>
<li>This basically shows a physical representation of your microcontroller. The boxes around it are the pins, corresponding to the actual pins on the microcontroller which can be configured to interact with the rest of your circuit.</li>
<li>The tan colored pins in the Device Configuration Tool correspond to power and ground pins, and cannot be configured in software. The yellow-greenish colored pins are reserved for reset and boot functions, so you also cannot do much with them in software. The green pins are those that are peripherals already located on our Nucleo. Everything else that is grayed out can be configured! Certain pins have access to certain features, which are delineated in the MCU’s (quite long) <a href="https://www.st.com/resource/en/datasheet/stm32f411ce.pdf" target="_blank" rel="noopener noreferrer">datasheet</a>. Don’t worry about this for now, you’ll learn as we go along.</li>
<li>Now let’s set up the pins for our button and LED!<!-- -->
<ul>
<li>Lucky for us, these pins are already set up, since they’re built into the Nucleo. However, for the sake of practice, go ahead and verify that pin PC13-ANTI_TAMP is set to GPIO-EXTI13, and that pin PA5 is set to GPIO_OUTPUT.</li>
</ul>
</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image17-9e096ec416247a3633f05c07cd64daed.png" title="image_tooltip" width="400" height="229" class="img_ev3q"></p>
<ul>
<li>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This assignment shows how to set up the button with an external interrupt. An interrupt is a signal that causes the main program you are running to be halted briefly to execute some side bit of code. Hence the _EXTI13 instead of _Input option. There are easier ways to implement an input button, but since external interrupts are used a lot in Micromouse, we’ll show you how to use them here.</p></div></div>
</li>
</ul>
<p>Before we actually begin writing code, there are a few more things we need to set.</p>
<ul>
<li>In the sidebar to the left, expand “System Core” and click “GPIO.” Make sure the “GPIO” tab is selected in the menu that pops out.</li>
<li>You should see the two pins from earlier here.</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image9-73b7c950b74f18eaf84c541069a9f65b.png" title="image_tooltip" width="493" height="254" class="img_ev3q"></p>
<ul>
<li>Let’s start by giving them more useful names. Click on the PC13-ANTI-TAMP and in the menu that pops up at the bottom change the “User Label” field to “Button.”</li>
<li>Change PA5’s user label to “LED.”<!-- -->
<ul>
<li>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You can usually name these whatever you want, but since the provided code later in this assignment assumes these are the pin names, it’s best you use these labels for this assignment.</p></div></div>
</li>
</ul>
</li>
<li>Click on PC13-ANTI-TAMP again and change the “GPIO mode” field to “<strong>External Interrupt Mode with Rising/Falling edge trigger detection.”</strong>
<ul>
<li>This means that whenever the MCU detects that the button is being pushed down OR depressed, aka whenever there is a sharp rise or edge in the voltage OR a sharp decreasing edge in the voltage sensed by the pin, it will update the button. By default this is set to “External Interrupt Mode with Rising edge trigger detection,” which would toggle the button every time you press it instead of turning on when pressed and turning off when released. Try it out if you are curious to see it!</li>
</ul>
</li>
<li>Navigate to the NVIC tab and make sure EXTI interrupts are enabled.</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image9-73b7c950b74f18eaf84c541069a9f65b.png" title="image_tooltip" width="493" height="254" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-generate-driver-code">Step 2: Generate Driver Code<a href="#step-2-generate-driver-code" class="hash-link" aria-label="Direct link to Step 2: Generate Driver Code" title="Direct link to Step 2: Generate Driver Code">​</a></h3>
<p>We have finished pin configuration, so let’s generate our pin configuration code!</p>
<ul>
<li>Near the top of your window, there’s a button with a gear looking icon. Click it to generate the driver code based on the pin settings we have chosen.</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAAtCAYAAAAUX8MIAAAE8UlEQVRoBe2Xe0xbVRzHb4xGTXQxGTH+MZGYJZhtarapi0YzFjYlJqKTxETEDB9zM9li5pvBkrlowtymwhTDUKS01TkYg1KgjJbH+ri97aUVyqM8Wnop4EorVILbfPE195iVu7u2u3VugdImv/Tcc07O9/c53985vaWwBD7UEmDE0oCcmZlBvAcVDAYR70FxE+cQ75GAjBeHE04mnFxEF1aiXBdquap7LiCWWJRO8oAW13nJkYCMVK59dhPqa6tielMqKfkawoi0drh+sd5VOWlmWDBWG1xcMCpAfa0cRwr3Rp0jTJaHGxsbh883Ca1Wi/JyOQEWzonWFutJgdy8IzdUzpeUK8vaMTU1BdpsiQoqFo2WID/GQ3o8HGjaBLlcCaWy/ppDbnotex6SsdhwMbodvZidnYXf74fRZI4KeiUw4TgPqVKpUFFRgZKSUlRUVMUEKVyLb0tx8sHMTfOQPFS48Hg8MBgZySUpTkT4zEOOesdx6lQNZLIqNDY6rynkl5pOrH/rA2TuL0Slzg6KZW2gzVYSfX1O8gead/KM3ohBtz8spPgiEAIJ2+qDy9H6+e0EaHQ8AJWqDpWV1WjUeEhfx7FknD56b1gN4TpivXBO8mcwffvLSMvJwto9+ZB3qJBbnI/0fQdAGU3zbtG0BYFAAHqDKSIgLy7lTJ7YvwyOyhT4tY8QIM+oLwSpbnSRvr+57Ziw7IQi76aooGK9cJBNLAcSlhFseKcALxzajbS8Z9HcRYMyGM0hAa2uDR0dBgy4JkN9wh2V2tYcTkLnt/fAVZ2KaeNTl0M2DJO+P8cK8HugGh7rpzAoMyRrhoMUvhwU/tiMdW/nw+JmMeRzgtIb6NDiw1wQbu9M6FkqlHietjgZIydT4VWvxaw9mwCNen2or1eRcm1o4kjfH8MvAsFv8Nd0A3RlT0jWjQap1HZiyyvZWL3rQ3RyDPomukAxjBWM1Y4z+nlHxUmLn8VnRDyu+WwF3Cfvw88tG3GufzccdBGB4i+gi+HUbgG6b8Cc41/XreW3RYQU60WC3PzGNjyek4Xv1AakFRSiqEkGltOD4s+gz+eDVtsWUUQMIT4j4vH2ouWkXCf1mTg/8hEwXYyzjj1gNTlgVM/BT68Cum7GnP1GzP10K35jbgGnXhZRX6wXCZI/k63dPvLT8bGyAavefBc/WCpBeb1e6HRtcA5f3TkUgvafzkV3bQY8rVnAL18B00eA8WxgMBVwrgBGnwfO5gH+fWQz+AvKplgTEVK4Nt+OBCk8lw9vfRIvHSzB/bv2gmpp0f2vgCSJwykof/9O9DZkYnroE7jbtyJgfhToTwaGHsOvPdswYnoPAa4WnO0LMlcMEu1ZCuQDz6ShzjQIefsAKLGDZmsPlEolFAoFaItD8u6GS4pRrsOwZgMGapIISJC+Gxf6M2D5/iG4OnLgNuyASbExZg0pkEermvD0zldJ6V7y7sonKpPJUFZWhtLSUvIdLnnxRRBuDt/HyFeDVa4kgPpjSeirWYneuvVQH7qL9LFV6bAev/KtKtaTAtlk5ZD+ek54yEgJC/vFF4FwLFqbkaXAfmINqg/cEZN7Yj0pkOahWTTbxv47ZDSQ6zEmBVJ4CV1WrtcjyavV4CFjiUUJGesmJSBj3bGFOj/h5EJ1Jta8Ek7GumMLdf7ScJJlWcR7UN1cEPEeCch4cfgf5G11Wj1Hqr0AAAAASUVORK5CYII=" title="image_tooltip" width="57" height="45" class="img_ev3q"></p>
<ul>
<li>Once code generation is complete, in the left sidebar open Core → Inc → main.h.</li>
<li>Hopefully this happened automatically, but you should also change the perspective from Device Configuration Tool to C/C++. Click the box with a C in the upper right corner:</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="data:image/png;base64,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" title="image_tooltip" width="85" height="42" class="img_ev3q"></p>
<ul>
<li>This perspective allows you to see errors, warnings, and the debug console while you are coding.</li>
<li>Towards the bottom of main.h you should see some of the code generated for you!</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image1-1e92975476d80905737b478009c2cc84.png" title="image_tooltip" width="292" height="279" class="img_ev3q"></p>
<ul>
<li>If those names look familiar, it’s because they’re generated from the user labels in the device configuration tool! You’ll be using these constants in order to interface with the pins that we’ve defined.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>You’ve likely noticed by now there are a ton of comments generated inside of the files that look like this:</p><p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image15-d68d986790545bd114b2cb3bf775f39e.png" title="image_tooltip" width="767" height="413" class="img_ev3q"></p><p>Do <strong>NOT</strong> delete the comments. When writing code in generated files, you must write your code between the beginning and corresponding end of these commented sections. If you go back to the Device Configuration Tool and change anything and regenerate code, any code you have written that is not within these commented sections <strong>will be lost</strong>. You don’t have to worry about this for files that you create, only program generated ones like main.c and main.h</p></div></div>
<ul>
<li>Now open Core → Src → main.c. The main function for your program is in this file.<!-- -->
<ol>
<li>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>For those of you who have not worked much with C or C++ before, the two main file types are .h and .c. Header, or .h, files typically contain things like function declarations.</p></div></div>
</li>
<li>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The <code>SystemClock_Config</code> and <code>MX_GPIO_Init</code> functions are generated to implement the functionality we configured the pins with during pin configuration. The <code>MX_USART2_UART_Init</code> function is used for the built-in UART serial connection. You can ignore it safely for now. In the future when we use pins with different functions, additional functions will be generated.</p></div></div>
</li>
</ol>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-code-o-clock">Step 3: Code o’ Clock<a href="#step-3-code-o-clock" class="hash-link" aria-label="Direct link to Step 3: Code o’ Clock" title="Direct link to Step 3: Code o’ Clock">​</a></h3>
<ul>
<li>Normally your program code would go in the main function, but we are utilizing interrupts for this assignment. As described earlier, when an interrupt trigger is detected, the program (which is executing inside of the main function) pauses and a separate block of code is executed.</li>
<li>In main.c, scroll down until you see the following comments:</li>
</ul>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/** USER CODE BEGIN 4 **/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/** USER CODE END 4 **/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Our code will be placed between these two comments. Copy and paste the following between them:</li>
</ul>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">void</span><span class="token plain"> HAL</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">GPIO_EXTI_Callback</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token class-name" style="color:rgb(17, 17, 17)">uint16_t</span><span class="token plain"> GPIO_PIN</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">GPIO_PIN </span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token plain"> Button_Pin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/* Your code goes here */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>The <code>HAL_GPIO_EXTI_Callback</code> function looks kinda complicated, but basically the firmware in the MCU will call it whenever an interrupt is detected. There are several different pins with interrupts, so when the MCU calls this function it will pass in the pin that triggered the interrupt as the GPIO_PIN parameter. Most of the pin names are just constant unsigned integers, hence the uint16_t (unsigned 16-bit integer), that have a special reserved name associated with them. We typically only refer to the pins by their reserved names, like GPIO_PIN_3, and not their actual uint16_t value.</p>
<ul>
<li>The <code>HAL_GPIO_EXTI_Callback</code> function is already defined in the firmware of the MCU (you can find it in the other source files if you’re curious!), but it is empty and weakly defined, meaning we can define our own version that overrides it to do something useful.</li>
</ul>
</li>
<li>
<p>The if-statement just checks that the pin that called the interrupt is PC13, which as mentioned earlier in main.h has been assigned to the constant PushButton_Pin.</p>
</li>
<li>
<p>Inside the if-statement, write some code that toggles the LED whenever an interrupt is triggered by the button pin.</p>
<ul>
<li>
<p>To read, use the function</p>
<p>HAL_GPIO_ReadPin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin);</p>
<p>which takes in a port (which is of variable of type GPIO_TypeDef*) and a GPIO pin as parameters. This function will return one of two GPIO_PinStates:</p>
<ul>
<li>GPIO_PIN_SET for a high voltage, or</li>
<li>GPIO_PIN_RESET for a low voltage</li>
</ul>
</li>
<li>
<p>To write, use the function</p>
<p>HAL_GPIO_WritePin(GPIO_TypeDef* GPIOx, uint16_t
GPIO_Pin, GPIO_PinState PinState);</p>
</li>
</ul>
</li>
</ul>
<p>As parameters, it again takes in a port for GPIOx, a pin for GPIO_Pin, and a GPIO_PinState to set the pin to, which can be one of the two aforementioned values.</p>
<ul>
<li>
<p>Remember, the constants corresponding to the ports and pins for the pushbutton and LED pins are defined in main.h.</p>
</li>
<li>
<p>EXAMPLE: To set the LED pin to high, do the following:</p>
<p>HAL_GPIO_WritePin(LED_GPIO_Port, LED_Pin, GPIO_PIN_SET);</p>
</li>
<li>
<p>There are many ways to do this, but you can implement the appropriate logic with a simple if-else statement (i.e., if the button is pressed turn the LED on, else turn it off).</p>
</li>
<li>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>As can be seen in the mouse schematic, the user pushbutton is active low, meaning that when not being pressed it has a “high” value of 3.3V, and when the button is pressed it connects to ground and is “low.” Keep this in mind when writing your code.</p></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-upload-the-code">Step 4: Upload the Code<a href="#step-4-upload-the-code" class="hash-link" aria-label="Direct link to Step 4: Upload the Code" title="Direct link to Step 4: Upload the Code">​</a></h3>
<ul>
<li>Finally, it is time to upload your first program to your mouse.</li>
<li>If you haven’t already done so, make sure to snap the ST-Link portion of the Nucleo off so you can fit it on the mouse PCB.</li>
<li>Now, put the Nucleo on the mouse, making sure that you put it on in the right orientation.</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image5-6603ad5d9e52ab3ac6ee1d0f6e035002.png" title="image_tooltip" width="1017" height="763" class="img_ev3q"></p>
<ul>
<li>Connect the batteries to the connectors, then turn the switch to the ON position. Make sure that the red power light on the Nucleo turns on before proceeding.</li>
<li>Turn the Nucleo back off, then connect the ST-Link programmer to the mouse using the programming header.<!-- -->
<ul>
<li>On the ST-Link programmer, the pins on the programming header are, from top to bottom: 3.3V, SWCLK, GND, SWDIO, NRST, SWO. Connect those pins to the pins on the mouse PCB with the same name.</li>
<li>We are not using the top (3.3V) and bottom (SWO) pins on the ST-Link programmer.</li>
</ul>
</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image12-9e808d5ac5f9bd62b89fa21b7ec06d5a.png" title="image_tooltip" width="1017" height="763" class="img_ev3q"></p>
<p><img loading="lazy" alt="alt_text" src="/projects.ieeebruins.com/assets/images/image16-cfa44c999d5e11040261832cede3a577.png" title="image_tooltip" width="1017" height="763" class="img_ev3q"></p>
<ul>
<li>Make sure the headers on CN2 on the ST-Link programmer are removed. This tells the programmer that we are programming an externally-connected board. You can store the extra headers on the connectors labeled CN11 and CN12.</li>
<li>After plugging the ST-Link into your computer and ensuring the connections are right, turn on your mouse.</li>
<li>In CubeIDE, click File → Save All. (You hopefully have been doing this the whole time during the process?)</li>
<li>While in the C/C++ perspective, click Run → Debug As → STM32 MCU C/C++ Application</li>
<li>The first time you do this, a window will pop up asking you to edit your launch configuration. Just click “OK”</li>
<li>Your project should now build successfully assuming there are no bugs in your code.<!-- -->
<ul>
<li>If an Edit Launch Configuration Properties window pops up, click OK. Another window should pop up asking you to switch to the Debug perspective; click Switch.</li>
<li>If a window opens asking about updating the ST-Link, go ahead and click yes. Then click “Open in update mode”, then “Upgrade.” Once it says “Upgrade successful” in the bottom left, you can safely close that window</li>
</ul>
</li>
<li>Click the run button in the toolbar:</li>
</ul>
<p><img loading="lazy" alt="alt_text" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAZCAYAAAAv3j5gAAACQElEQVRIDb2UT2gTQRTGf/snmtjWRKEoFXsSpAEl1lSkUGiRYilVvFjqQYqg4KWIZ0Hw4EnBq55FpCKeFRE8CSoFD3qRShBrmtIQ26Ykm2RnRnYq29qMpuSwAwNv9r33vfe9+Wat9YqviGC5KpIy4EZUB5eIKEXHKCJC2BEITpeITnXQrLsPTzMoJUOyth1jYGqO609uczY9xMSxYWJuLPTvxDAyUsph9Op7lKxi2QlePcpqceaW87z9+oYXn15z+dQFRtODO6mhY+yAz/YtpcT3vuBX3iHr8wghdUzwfay/h6G+FLNzz7n2+BYfv39uyt+OF5xdw+QQDR9VL4KqI+sFpJC6G6kU6w3Bvr0JxrKHyS2tce/lQw6mDjAzMs2R7t5/MjSOzhcKvBKIdXB9hK/06AJG31bLm2Bxi/7j3Swul7k5e5cTvWnunLux6d9iucpASfoSqr/AX4VdaEZBnFSS+dWVLekbZrXRwIlZ/CjlMeEFUcbRSSHAtv5s9B0F/UipcC0vLORVBStLYPsxZoanGTl62iRiHW/8BclgdI6j+8BxkcHoQDNK7RZ4NUX+p6S8BlcGL3I+cwbHdgyzCXsyMxLCwunKgCiDm/yL0cKCz2JBMHlynMnsOJ3xjg20oJP/LCMjUavx7MElwCJQgVKW7rYzvoe+5AD3J6bY35HUsC3ww9JWoVhriq2UcniVYhiUSB4i0dUTntsxrELRayrUDlCrHOM7apXUjt94R+0AtcoxvqNWSe34o2QUiRb4DeIACGu7K8P0AAAAAElFTkSuQmCC" title="image_tooltip" width="26" height="25" class="img_ev3q"></p>
<ul>
<li>Your LED should now turn on when the button is pressed and turn off once released.</li>
<li>Press the big red square next to the run/resume button to terminate the debug session.</li>
</ul>
<p>Congratulations! You have now written your first program for your mouse!</p>
<p>Good job making it through this module! With the basics out of the way, you can now start to work towards the software that controls your mouse’s motors, IR sensors, and the maze solving algorithms that help the mouse solve the maze!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/UCLA-IEEE/projects.ieeebruins.com/tree/main/docs/micromouse/stm32cubeide-module.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/projects.ieeebruins.com/micromouse/microcontroller-module"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Microcontroller Module</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/projects.ieeebruins.com/micromouse/motor-setup-and-pid-module"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Motor Setup and PID Module</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#installing-cubeide" class="table-of-contents__link toc-highlight">Installing CubeIDE</a><ul><li><a href="#step-1-download-installer" class="table-of-contents__link toc-highlight">Step 1: Download Installer</a></li><li><a href="#step-2-setup-cubeide" class="table-of-contents__link toc-highlight">Step 2: Setup CubeIDE</a></li></ul></li><li><a href="#coding-in-cubeide" class="table-of-contents__link toc-highlight">Coding in CubeIDE</a></li><li><a href="#step-1-configure-microcontroller-pins" class="table-of-contents__link toc-highlight">Step 1: Configure Microcontroller Pins</a><ul><li><a href="#step-2-generate-driver-code" class="table-of-contents__link toc-highlight">Step 2: Generate Driver Code</a></li><li><a href="#step-3-code-o-clock" class="table-of-contents__link toc-highlight">Step 3: Code o’ Clock</a></li><li><a href="#step-4-upload-the-code" class="table-of-contents__link toc-highlight">Step 4: Upload the Code</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More of us!</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/RREtsea" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://instagram.com/uclaieee" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 IEEE at UCLA. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>